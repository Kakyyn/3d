<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, maximum-scale=5.0">
    <title>3D Control Center v2.0</title>
    <meta name="description" content="Panel de control para negocio de impresi√≥n 3D">
    <meta name="theme-color" content="#1a1a1a">
    
    <!-- PWA Meta Tags -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="3D Control">
    
    <!-- iOS Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="3D Control">
    <meta name="format-detection" content="telephone=no">
    
    <!-- iOS Icons -->
    <link rel="apple-touch-icon" sizes="57x57" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 57 57'%3E%3Crect width='57' height='57' rx='12' fill='%23ff6b35'/%3E%3Ctext x='28.5' y='35' text-anchor='middle' font-size='20' font-weight='bold' fill='white'%3E3D%3C/text%3E%3C/svg%3E">
    <link rel="apple-touch-icon" sizes="60x60" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 60 60'%3E%3Crect width='60' height='60' rx='13' fill='%23ff6b35'/%3E%3Ctext x='30' y='37' text-anchor='middle' font-size='22' font-weight='bold' fill='white'%3E3D%3C/text%3E%3C/svg%3E">
    <link rel="apple-touch-icon" sizes="72x72" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 72 72'%3E%3Crect width='72' height='72' rx='16' fill='%23ff6b35'/%3E%3Ctext x='36' y='45' text-anchor='middle' font-size='28' font-weight='bold' fill='white'%3E3D%3C/text%3E%3C/svg%3E">
    <link rel="apple-touch-icon" sizes="76x76" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 76 76'%3E%3Crect width='76' height='76' rx='17' fill='%23ff6b35'/%3E%3Ctext x='38' y='47' text-anchor='middle' font-size='30' font-weight='bold' fill='white'%3E3D%3C/text%3E%3C/svg%3E">
    <link rel="apple-touch-icon" sizes="114x114" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 114 114'%3E%3Crect width='114' height='114' rx='25' fill='%23ff6b35'/%3E%3Ctext x='57' y='70' text-anchor='middle' font-size='42' font-weight='bold' fill='white'%3E3D%3C/text%3E%3C/svg%3E">
    <link rel="apple-touch-icon" sizes="120x120" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 120 120'%3E%3Crect width='120' height='120' rx='26' fill='%23ff6b35'/%3E%3Ctext x='60' y='75' text-anchor='middle' font-size='46' font-weight='bold' fill='white'%3E3D%3C/text%3E%3C/svg%3E">
    <link rel="apple-touch-icon" sizes="144x144" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 144 144'%3E%3Crect width='144' height='144' rx='32' fill='%23ff6b35'/%3E%3Ctext x='72' y='90' text-anchor='middle' font-size='56' font-weight='bold' fill='white'%3E3D%3C/text%3E%3C/svg%3E">
    <link rel="apple-touch-icon" sizes="152x152" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 152 152'%3E%3Crect width='152' height='152' rx='33' fill='%23ff6b35'/%3E%3Ctext x='76' y='95' text-anchor='middle' font-size='58' font-weight='bold' fill='white'%3E3D%3C/text%3E%3C/svg%3E">
    <link rel="apple-touch-icon" sizes="180x180" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 180 180'%3E%3Crect width='180' height='180' rx='40' fill='%23ff6b35'/%3E%3Ctext x='90' y='112' text-anchor='middle' font-size='68' font-weight='bold' fill='white'%3E3D%3C/text%3E%3C/svg%3E">
    
    <!-- Standard Icons -->
    <link rel="icon" type="image/png" sizes="32x32" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Crect width='32' height='32' fill='%23ff6b35'/%3E%3Ctext x='16' y='20' text-anchor='middle' font-size='18' fill='white'%3E3D%3C/text%3E%3C/svg%3E">
    <link rel="icon" type="image/png" sizes="16x16" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Crect width='16' height='16' fill='%23ff6b35'/%3E%3Ctext x='8' y='12' text-anchor='middle' font-size='10' fill='white'%3E3D%3C/text%3E%3C/svg%3E">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <!-- Styles -->
    <link rel="stylesheet" href="style.css?v=2025112201">
</head>
<body>
    <div id="app">
        <!-- Mobile Menu Toggle -->
        <button class="mobile-menu-toggle" onclick="toggleMobileMenu()">
            <i class="fas fa-bars"></i>
        </button>
        
        <!-- Mobile Overlay -->
        <div class="mobile-overlay" onclick="closeMobileMenu()"></div>
        
        <!-- Sidebar Navigation -->
        <nav class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h1><i class="fas fa-cube"></i> 3D Control</h1>
            </div>
            
            <ul class="nav-menu">
                <li><a href="#" data-page="dashboard" class="nav-link active">
                    <i class="fas fa-tachometer-alt"></i> Dashboard
                </a></li>
                <li><a href="#" data-page="productos" class="nav-link">
                    <i class="fas fa-box"></i> Productos
                </a></li>
                <li><a href="#" data-page="insumos" class="nav-link">
                    <i class="fas fa-industry"></i> Insumos
                </a></li>
                <li><a href="#" data-page="calculo" class="nav-link">
                    <i class="fas fa-calculator"></i> Calcular Costo
                </a></li>
                <li><a href="#" data-page="pedidos" class="nav-link">
                    <i class="fas fa-clipboard-list"></i> Pedidos
                </a></li>
                <li><a href="#" data-page="clientes" class="nav-link">
                    <i class="fas fa-users"></i> Clientes
                </a></li>
                <li><a href="#" data-page="cotizaciones" class="nav-link">
                    <i class="fas fa-file-invoice-dollar"></i> Cotizaciones
                </a></li>
                <li><a href="#" data-page="facturacion" class="nav-link">
                    <i class="fas fa-receipt"></i> Facturaci√≥n
                </a></li>
                <li><a href="#" data-page="proveedores" class="nav-link">
                    <i class="fas fa-truck"></i> Proveedores
                </a></li>
                <li><a href="#" data-page="equipos" class="nav-link">
                    <i class="fas fa-tools"></i> Equipos
                </a></li>
                <li><a href="#" data-page="reportes" class="nav-link">
                    <i class="fas fa-chart-bar"></i> Reportes
                </a></li>
                <li><a href="#" data-page="finanzas" class="nav-link">
                    <i class="fas fa-money-bill-wave"></i> Finanzas
                </a></li>
                <li><a href="#" data-page="configuracion" class="nav-link">
                    <i class="fas fa-cog"></i> Configuraci√≥n
                </a></li>
            </ul>
            
            <div class="sidebar-footer">
                <p>&copy; 2025 3D Control Center</p>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Dashboard Page -->
            <div id="dashboard-page" class="page active">
                <div class="page-header">
                    <h2>Dashboard</h2>
                    <p>Resumen general de tu negocio</p>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-box"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="total-productos">0</h3>
                            <p>Productos en Stock</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-industry"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="total-insumos">0</h3>
                            <p>Tipos de Material</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-clipboard-list"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="pedidos-activos">0</h3>
                            <p>Pedidos Activos</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-dollar-sign"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="ganancia-estimada">‚Ç°0</h3>
                            <p>Ganancia Estimada</p>
                        </div>
                    </div>
                </div>
                
                <div class="dashboard-content">
                    <div class="recent-activity">
                        <h3>Actividad Reciente</h3>
                        <div id="recent-list" class="activity-list">
                            <p>No hay actividad reciente</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Productos Page -->
            <div id="productos-page" class="page">
                <div class="page-header">
                    <h2>Inventario de Productos</h2>
                    <button class="btn btn-primary" onclick="openProductModal()">
                        <i class="fas fa-plus"></i> Agregar Producto
                    </button>
                </div>
                
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Nombre</th>
                                <th>Descripci√≥n</th>
                                <th>Categor√≠a</th>
                                <th>Precio</th>
                                <th>Stock</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="productos-tbody">
                            <tr>
                                <td colspan="6" class="empty-state">No hay productos registrados</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Insumos Page -->
            <div id="insumos-page" class="page">
                <div class="page-header">
                    <h2>Inventario de Insumos</h2>
                    <div class="page-actions">
                        <button class="btn btn-secondary" onclick="openConsumoModal()">
                            <i class="fas fa-minus-circle"></i> Registrar Consumo
                        </button>
                        <button class="btn btn-primary" onclick="openInsumoModal()">
                            <i class="fas fa-plus"></i> Agregar Material
                        </button>
                    </div>
                </div>
                
                <div class="insumos-content">
                    <!-- Tabla de Inventario -->
                    <div class="table-container">
                        <h3>Inventario Actual</h3>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Material</th>
                                    <th>Color</th>
                                    <th>Peso Disponible</th>
                                    <th>Costo/kg</th>
                                    <th>Valor Total</th>
                                    <th>Estado</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="insumos-tbody">
                                <tr>
                                    <td colspan="7" class="empty-state">No hay materiales registrados</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Historial de Consumo -->
                    <div class="consumo-history">
                        <h3>Historial de Consumo</h3>
                        <div class="consumo-filters">
                            <select id="filtro-material-consumo">
                                <option value="">Todos los materiales</option>
                            </select>
                            <select id="filtro-periodo">
                                <option value="7">√öltimos 7 d√≠as</option>
                                <option value="30">√öltimos 30 d√≠as</option>
                                <option value="90">√öltimos 3 meses</option>
                                <option value="all">Todo el historial</option>
                            </select>
                        </div>
                        <div id="consumo-list" class="consumo-list">
                            <p>No hay registros de consumo</p>
                        </div>
                    </div>

                    <!-- Estad√≠sticas de Consumo -->
                    <div class="consumo-stats">
                        <h3>Estad√≠sticas de Consumo</h3>
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-icon">
                                    <i class="fas fa-chart-line"></i>
                                </div>
                                <div class="stat-info">
                                    <h3 id="consumo-mes">0 kg</h3>
                                    <p>Consumo este mes</p>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon">
                                    <i class="fas fa-exclamation-triangle"></i>
                                </div>
                                <div class="stat-info">
                                    <h3 id="materiales-bajos">0</h3>
                                    <p>Materiales con stock bajo</p>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon">
                                    <i class="fas fa-dollar-sign"></i>
                                </div>
                                <div class="stat-info">
                                    <h3 id="costo-consumo-mes">‚Ç°0</h3>
                                    <p>Costo consumo mensual</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Calculo Page -->
            <div id="calculo-page" class="page">
                <div class="page-header">
                    <h2>Calculadora de Precio de Impresi√≥n 3D ‚úÖ ACTUALIZADA</h2>
                    <p>Calcula el precio completo de impresi√≥n 3D considerando todos los costos</p>
                    <div style="background: #4caf50; color: white; padding: 10px; border-radius: 5px; margin: 10px 0; text-align: center;">
                        üöÄ Nueva versi√≥n basada en Prusa3D - M√°s precisa y profesional
                    </div>
                </div>
                
                <div class="calc-main-container">
                    <!-- Informaci√≥n b√°sica de la impresi√≥n -->
                    <div class="calc-section">
                        <h3><i class="fas fa-info-circle"></i> Informaci√≥n de la Impresi√≥n</h3>
                        <form id="calc-form" class="calc-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="calc-nombre">Nombre del trabajo:</label>
                                    <input type="text" id="calc-nombre" name="nombre" placeholder="Ej: Miniatura de drag√≥n">
                                </div>
                                <div class="form-group">
                                    <label for="calc-cantidad">Cantidad de piezas:</label>
                                    <input type="number" id="calc-cantidad" name="cantidad" min="1" value="1" required>
                                </div>
                            </div>
                            
                            <!-- Secci√≥n de Filamento -->
                            <div class="calc-subsection">
                                <h4><i class="fas fa-industry"></i> Filamento</h4>
                                
                                <!-- Tipo de filamento -->
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="calc-material">Tipo de filamento</label>
                                        <select id="calc-material" name="material" required onchange="CostCalculator.updateMaterialCost(); CostCalculator.updateFilamentCost()">
                                            <option value="">Seleccionar material...</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="calc-peso-bobina">Peso de la bobina</label>
                                        <div class="input-with-unit">
                                            <input type="number" id="calc-peso-bobina" name="peso-bobina" value="1000" step="100" min="0" oninput="CostCalculator.updateFilamentCost()">
                                            <span class="unit-suffix">g</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Peso y factor de desperdicio -->
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="calc-peso">Peso de la impresi√≥n (g por pieza):</label>
                                        <input type="number" id="calc-peso" name="peso" min="0.1" step="0.1" required oninput="CostCalculator.updateFilamentCost()">
                                    </div>
                                    <div class="form-group">
                                        <label for="calc-desperdicio">Factor de desperdicio</label>
                                        <div class="slider-container">
                                            <input type="range" id="calc-desperdicio" name="desperdicio" min="0" max="50" value="5" step="1" oninput="CostCalculator.updateFilamentCost(); document.getElementById('desperdicio-display').textContent = this.value + '%'">
                                            <div class="slider-value" id="desperdicio-display">5%</div>
                                        </div>
                                        <div class="help-text">Incluye purga, torre de limpieza, fallos, etc.</div>
                                    </div>
                                </div>

                                <!-- Resultado calculado autom√°ticamente -->
                                <div class="form-row">
                                    <div class="calc-result-row">
                                        <span class="result-label">Coste total del filamento:</span>
                                        <span class="result-value" id="costo-filamento-calculado">CRC 0.00</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Secci√≥n de Tiempo de Impresi√≥n -->
                            <div class="calc-subsection">
                                <h4><i class="fas fa-clock"></i> Tiempo de Impresi√≥n</h4>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="calc-tiempo">Tiempo de impresi√≥n (horas):</label>
                                        <input type="number" id="calc-tiempo" name="tiempo" min="0.1" step="0.1" required oninput="CostCalculator.updateElectricityCost(); CostCalculator.updateLaborCost()">
                                    </div>
                                    <div class="form-group">
                                        <label for="calc-tiempo-fallo">Factor de fallos</label>
                                        <div class="slider-container">
                                            <input type="range" id="calc-tiempo-fallo" name="tiempo-fallo" min="0" max="50" value="5" step="1" oninput="document.getElementById('fallo-display').textContent = this.value + '%'">
                                            <div class="slider-value" id="fallo-display">5%</div>
                                        </div>
                                        <div class="help-text">Tiempo adicional por posibles fallos</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Secci√≥n de Electricidad -->
                            <div class="calc-subsection">
                                <h4><i class="fas fa-bolt"></i> Electricidad</h4>
                                
                                <!-- Consumo de energ√≠a -->
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="calc-consumo-energia">Consumo de energ√≠a</label>
                                        <div class="slider-container">
                                            <input type="range" id="calc-consumo-energia" name="consumo-energia" min="50" max="500" value="120" step="10" oninput="CostCalculator.updateElectricityCost(); document.getElementById('consumo-display').textContent = this.value + ' W'">
                                            <div class="slider-value" id="consumo-display">120 W</div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="calc-costo-energia">Costo energ√≠a</label>
                                        <div class="slider-container">
                                            <input type="range" id="calc-costo-energia" name="costo-energia" min="50" max="200" value="110" step="5" oninput="CostCalculator.updateElectricityCost(); document.getElementById('costo-energia-display').textContent = this.value + ' CRC'">
                                            <div class="slider-value" id="costo-energia-display">110 CRC</div>
                                        </div>
                                        <div class="help-text">por kWh</div>
                                    </div>
                                </div>

                                <!-- Resultado calculado autom√°ticamente -->
                                <div class="form-row">
                                    <div class="calc-result-row">
                                        <span class="result-label">Coste total de electricidad:</span>
                                        <span class="result-value" id="costo-electricidad-calculado">CRC 0.00</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Secci√≥n de Costo de mano de obra -->
                            <div class="calc-subsection">
                                <h4><i class="fas fa-user"></i> Coste de mano de obra</h4>
                                
                                <!-- Preparaci√≥n de la impresi√≥n -->
                                <div class="labor-subsection">
                                    <h5>Preparaci√≥n de la impresi√≥n</h5>
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label for="calc-tiempo-prep">Tiempo</label>
                                            <div class="input-with-unit">
                                                <input type="number" id="calc-tiempo-prep" name="tiempo-prep" value="15" step="1" min="0" oninput="CostCalculator.updateLaborCost()">
                                                <span class="unit-suffix">Min.</span>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label for="calc-costo-prep">Costo</label>
                                            <div class="input-with-unit">
                                                <span class="unit-prefix">CRC</span>
                                                <input type="number" id="calc-costo-prep" name="costo-prep" value="1000" step="100" min="0" oninput="CostCalculator.updateLaborCost()">
                                                <span class="unit-suffix">por hora</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Post-procesamiento -->
                                <div class="labor-subsection">
                                    <h5>Post-procesamiento</h5>
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label for="calc-tiempo-post">Tiempo</label>
                                            <div class="input-with-unit">
                                                <input type="number" id="calc-tiempo-post" name="tiempo-post" value="10" step="1" min="0" oninput="CostCalculator.updateLaborCost()">
                                                <span class="unit-suffix">Min.</span>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label for="calc-costo-post">Costo</label>
                                            <div class="input-with-unit">
                                                <span class="unit-prefix">CRC</span>
                                                <input type="number" id="calc-costo-post" name="costo-post" value="0" step="100" min="0" oninput="CostCalculator.updateLaborCost()">
                                                <span class="unit-suffix">por hora</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Resultado calculado autom√°ticamente -->
                                <div class="form-row">
                                    <div class="calc-result-row">
                                        <span class="result-label">Coste total de mano de obra:</span>
                                        <span class="result-value" id="costo-mano-obra-calculado">CRC 0.00</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Secci√≥n de Mantenimiento y M√°quina -->
                            <div class="calc-subsection">
                                <h4><i class="fas fa-tools"></i> Costo de m√°quina y mantenimiento</h4>
                                
                                <!-- Costo de la impresora -->
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="calc-costo-impresora">Coste de la impresora</label>
                                        <div class="input-with-unit">
                                            <span class="unit-prefix">CRC</span>
                                            <input type="number" id="calc-costo-impresora" name="costo-impresora" value="250000" step="1000" min="0" oninput="CostCalculator.updateEquipmentCost()">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="calc-retorno-inversion">Retorno de la inversi√≥n</label>
                                        <div class="input-with-unit">
                                            <input type="number" id="calc-retorno-inversion" name="retorno-inversion" value="2" step="0.1" min="0.1" oninput="CostCalculator.updateEquipmentCost()">
                                            <span class="unit-suffix">A√±os</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Uso comercial diario -->
                                <div class="form-row">
                                    <div class="form-group full-width">
                                        <label for="calc-uso-comercial">Uso comercial diario</label>
                                        <div class="slider-container">
                                            <input type="range" id="calc-uso-comercial" name="uso-comercial" min="1" max="24" value="6" step="1" oninput="CostCalculator.updateEquipmentCost(); document.getElementById('uso-comercial-display').textContent = this.value + ' h'">
                                            <div class="slider-value" id="uso-comercial-display">6 h</div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Porcentaje del coste de compra que esperas gastar en reparaciones -->
                                <div class="form-row">
                                    <div class="form-group full-width">
                                        <label for="calc-porcentaje-reparacion">Porcentaje del coste de compra de la impresora que esperas gastar en reparaciones durante su vida √∫til</label>
                                        <div class="slider-container">
                                            <input type="range" id="calc-porcentaje-reparacion" name="porcentaje-reparacion" min="0" max="50" value="5" step="1" oninput="CostCalculator.updateEquipmentCost(); document.getElementById('reparacion-display').textContent = this.value + ' %'">
                                            <div class="slider-value" id="reparacion-display">5 %</div>
                                        </div>
                                        <div class="help-text">Costes de reparaci√≥n</div>
                                    </div>
                                </div>

                                <!-- Resultado calculado autom√°ticamente -->
                                <div class="form-row">
                                    <div class="calc-result-row">
                                        <span class="result-label">Coste total de m√°quina y mantenimiento:</span>
                                        <span class="result-value" id="costo-maquina-calculado">CRC 0.00</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Secci√≥n de Otros Costos -->
                            <div class="calc-subsection">
                                <h4><i class="fas fa-plus-circle"></i> Otros Costos</h4>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="calc-packaging">Empaque y env√≠o (‚Ç°):</label>
                                        <input type="number" id="calc-packaging" name="packaging" min="0" value="0" step="100">
                                    </div>
                                    <div class="form-group">
                                        <label for="calc-otros-gastos">Otros gastos operativos (‚Ç°):</label>
                                        <input type="number" id="calc-otros-gastos" name="otros-gastos" min="0" value="0" step="100">
                                        <small>Alquiler, internet, software, etc.</small>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Secci√≥n de Precio Final -->
                            <div class="calc-subsection">
                                <h4><i class="fas fa-dollar-sign"></i> Precio Final</h4>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="calc-margen">Margen de ganancia (%):</label>
                                        <input type="number" id="calc-margen" name="margen" min="0" max="1000" step="5">
                                    </div>
                                    <div class="form-group">
                                        <label for="calc-descuento">Descuento aplicado (%):</label>
                                        <input type="number" id="calc-descuento" name="descuento" min="0" max="100" value="0" step="1">
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Secci√≥n de Impuestos -->
                            <div class="calc-subsection">
                                <h4><i class="fas fa-receipt"></i> Impuestos</h4>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="calc-incluir-iva">Incluir IVA:</label>
                                        <select id="calc-incluir-iva" name="incluir-iva">
                                            <option value="true">S√≠, incluir IVA (13%)</option>
                                            <option value="false">No incluir IVA</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="calc-iva-porcentaje">Porcentaje de IVA (%):</label>
                                        <input type="number" id="calc-iva-porcentaje" name="iva-porcentaje" value="13" min="0" max="50" step="0.1">
                                        <small>Costa Rica: 13% est√°ndar</small>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="calc-submit-section">
                                <button type="submit" class="btn btn-primary btn-large">
                                    <i class="fas fa-calculator"></i> Calcular Precio
                                </button>
                                <button type="button" class="btn btn-secondary" onclick="resetCalculator()">
                                    <i class="fas fa-undo"></i> Limpiar
                                </button>
                            </div>
                        </form>
                    </div>
                    
                    <!-- Resultados -->
                    <div id="calc-results" class="calc-results" style="display: none;">
                        <h3><i class="fas fa-receipt"></i> Resultado del C√°lculo</h3>
                        
                        <div class="results-summary">
                            <div class="result-highlight">
                                <span class="result-label">Precio Final Sugerido</span>
                                <span class="result-value-main" id="precio-final-total">‚Ç°0</span>
                                <span class="result-per-unit">Por pieza: <span id="precio-por-pieza">‚Ç°0</span></span>
                            </div>
                        </div>
                        
                        <div class="results-breakdown">
                            <h4>Desglose de Costos</h4>
                            
                            <div class="result-section">
                                <h5><i class="fas fa-industry"></i> Filamento</h5>
                                <div class="result-item">
                                    <span>Costo de material (peso + desperdicio):</span>
                                    <span id="costo-material-total">‚Ç°0</span>
                                </div>
                                <div class="result-item-detail">
                                    <span>Peso efectivo: <span id="peso-efectivo">0g</span></span>
                                </div>
                            </div>
                            
                            <div class="result-section">
                                <h5><i class="fas fa-clock"></i> Tiempo y Mano de Obra</h5>
                                <div class="result-item">
                                    <span>Costo de mano de obra:</span>
                                    <span id="costo-mano-obra">‚Ç°0</span>
                                </div>
                                <div class="result-item-detail">
                                    <span>Tiempo total: <span id="tiempo-total">0h</span></span>
                                </div>
                            </div>
                            
                            <div class="result-section">
                                <h5><i class="fas fa-bolt"></i> Electricidad</h5>
                                <div class="result-item">
                                    <span>Costo de electricidad:</span>
                                    <span id="costo-electricidad">‚Ç°0</span>
                                </div>
                                <div class="result-item-detail">
                                    <span>Consumo: <span id="consumo-kwh">0 kWh</span></span>
                                </div>
                            </div>
                            
                            <div class="result-section">
                                <h5><i class="fas fa-tools"></i> Equipos y Mantenimiento</h5>
                                <div class="result-item">
                                    <span>Depreciaci√≥n de equipos:</span>
                                    <span id="costo-depreciacion">‚Ç°0</span>
                                </div>
                                <div class="result-item">
                                    <span>Mantenimiento:</span>
                                    <span id="costo-mantenimiento">‚Ç°0</span>
                                </div>
                            </div>
                            
                            <div class="result-section">
                                <h5><i class="fas fa-plus-circle"></i> Otros Costos</h5>
                                <div class="result-item">
                                    <span>Empaque y env√≠o:</span>
                                    <span id="costo-packaging-result">‚Ç°0</span>
                                </div>
                                <div class="result-item">
                                    <span>Otros gastos:</span>
                                    <span id="costo-otros-result">‚Ç°0</span>
                                </div>
                            </div>
                            
                            <div class="result-totals">
                                <div class="result-item subtotal">
                                    <span>Subtotal (costos):</span>
                                    <span id="subtotal-costos">‚Ç°0</span>
                                </div>
                                <div class="result-item">
                                    <span>Margen de ganancia (<span id="margen-aplicado">0</span>%):</span>
                                    <span id="ganancia-calculada">‚Ç°0</span>
                                </div>
                                <div class="result-item">
                                    <span>Descuento aplicado:</span>
                                    <span id="descuento-aplicado">-‚Ç°0</span>
                                </div>
                                <div class="result-item">
                                    <span>Subtotal antes de IVA:</span>
                                    <span id="subtotal-antes-iva">‚Ç°0</span>
                                </div>
                                <div class="result-item">
                                    <span>IVA (<span id="iva-porcentaje-resultado">13</span>%):</span>
                                    <span id="iva-calculado">‚Ç°0</span>
                                </div>
                                <div class="result-item total">
                                    <span>PRECIO FINAL (con IVA):</span>
                                    <span id="precio-final">‚Ç°0</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="calc-actions">
                            <button class="btn btn-secondary" onclick="saveAsProduct()">
                                <i class="fas fa-box"></i> Guardar como producto
                            </button>
                            <button class="btn btn-primary" onclick="createOrder()">
                                <i class="fas fa-clipboard-list"></i> Crear pedido
                            </button>
                            <button class="btn btn-info" onclick="shareCalculation()">
                                <i class="fas fa-share"></i> Compartir c√°lculo
                            </button>
                            <button class="btn btn-success" onclick="printCalculation()">
                                <i class="fas fa-print"></i> Imprimir resumen
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Pedidos Page -->
            <div id="pedidos-page" class="page">
                <div class="page-header">
                    <h2>Pedidos Personalizados</h2>
                    <button class="btn btn-primary" onclick="openPedidoModal()">
                        <i class="fas fa-plus"></i> Nuevo Pedido
                    </button>
                </div>
                
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Cliente</th>
                                <th>Descripci√≥n</th>
                                <th>Material</th>
                                <th>Precio</th>
                                <th>Estado</th>
                                <th>Fecha</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="pedidos-tbody">
                            <tr>
                                <td colspan="7" class="empty-state">No hay pedidos registrados</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Facturaci√≥n Page -->
            <div id="facturacion-page" class="page">
                <div class="page-header">
                    <h2>Facturaci√≥n</h2>
                    <button class="btn btn-primary" onclick="openFacturaModal()">
                        <i class="fas fa-plus"></i> Nueva Factura
                    </button>
                </div>
                
                <div class="factura-container">
                    <div class="factura-list">
                        <h3>Historial de Facturas</h3>
                        <div id="facturas-list" class="facturas-grid">
                            <p>No hay facturas registradas</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Clientes Page -->
            <div id="clientes-page" class="page">
                <div class="page-header">
                    <h2>Gesti√≥n de Clientes</h2>
                    <button class="btn btn-primary" onclick="openClienteModal()">
                        <i class="fas fa-plus"></i> Agregar Cliente
                    </button>
                </div>
                
                <div class="clientes-content">
                    <div class="clientes-stats">
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-icon">
                                    <i class="fas fa-users"></i>
                                </div>
                                <div class="stat-info">
                                    <h3 id="total-clientes">0</h3>
                                    <p>Total Clientes</p>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon">
                                    <i class="fas fa-star"></i>
                                </div>
                                <div class="stat-info">
                                    <h3 id="clientes-activos">0</h3>
                                    <p>Clientes Activos</p>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon">
                                    <i class="fas fa-dollar-sign"></i>
                                </div>
                                <div class="stat-info">
                                    <h3 id="valor-promedio-cliente">‚Ç°0</h3>
                                    <p>Valor Promedio</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Nombre</th>
                                    <th>Email</th>
                                    <th>Tel√©fono</th>
                                    <th>Pedidos</th>
                                    <th>Total Gastado</th>
                                    <th>√öltimo Pedido</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="clientes-tbody">
                                <tr>
                                    <td colspan="7" class="empty-state">No hay clientes registrados</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Cotizaciones Page -->
            <div id="cotizaciones-page" class="page">
                <div class="page-header">
                    <h2>Cotizaciones y Presupuestos</h2>
                    <button class="btn btn-primary" onclick="openCotizacionModal()">
                        <i class="fas fa-plus"></i> Nueva Cotizaci√≥n
                    </button>
                </div>
                
                <div class="cotizaciones-content">
                    <div class="cotizaciones-filters">
                        <select id="filtro-estado-cotizacion">
                            <option value="">Todos los estados</option>
                            <option value="Borrador">Borrador</option>
                            <option value="Enviada">Enviada</option>
                            <option value="Aceptada">Aceptada</option>
                            <option value="Rechazada">Rechazada</option>
                            <option value="Vencida">Vencida</option>
                        </select>
                        <select id="filtro-cliente-cotizacion">
                            <option value="">Todos los clientes</option>
                        </select>
                    </div>
                    
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>N√∫mero</th>
                                    <th>Cliente</th>
                                    <th>Descripci√≥n</th>
                                    <th>Total</th>
                                    <th>Estado</th>
                                    <th>Fecha</th>
                                    <th>Vence</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="cotizaciones-tbody">
                                <tr>
                                    <td colspan="8" class="empty-state">No hay cotizaciones registradas</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Proveedores Page -->
            <div id="proveedores-page" class="page">
                <div class="page-header">
                    <h2>Proveedores y Compras</h2>
                    <div class="page-actions">
                        <button class="btn btn-secondary" onclick="openCompraModal()">
                            <i class="fas fa-shopping-cart"></i> Registrar Compra
                        </button>
                        <button class="btn btn-primary" onclick="openProveedorModal()">
                            <i class="fas fa-plus"></i> Agregar Proveedor
                        </button>
                    </div>
                </div>
                
                <div class="proveedores-content">
                    <div class="proveedores-section">
                        <h3>Proveedores</h3>
                        <div class="table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Nombre</th>
                                        <th>Contacto</th>
                                        <th>Especialidad</th>
                                        <th>Compras</th>
                                        <th>Total Gastado</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody id="proveedores-tbody">
                                    <tr>
                                        <td colspan="6" class="empty-state">No hay proveedores registrados</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div class="compras-section">
                        <h3>Historial de Compras</h3>
                        <div class="table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Fecha</th>
                                        <th>Proveedor</th>
                                        <th>Descripci√≥n</th>
                                        <th>Cantidad</th>
                                        <th>Costo Total</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody id="compras-tbody">
                                    <tr>
                                        <td colspan="6" class="empty-state">No hay compras registradas</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Equipos Page -->
            <div id="equipos-page" class="page">
                <div class="page-header">
                    <h2>Mantenimiento de Equipos</h2>
                    <div class="page-actions">
                        <button class="btn btn-secondary" onclick="openMantenimientoModal()">
                            <i class="fas fa-wrench"></i> Registrar Mantenimiento
                        </button>
                        <button class="btn btn-primary" onclick="openEquipoModal()">
                            <i class="fas fa-plus"></i> Agregar Equipo
                        </button>
                    </div>
                </div>
                
                <div class="equipos-content">
                    <div class="equipos-section">
                        <h3>Inventario de Equipos</h3>
                        <div class="table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Nombre</th>
                                        <th>Tipo</th>
                                        <th>Modelo</th>
                                        <th>Estado</th>
                                        <th>√öltimo Mantenimiento</th>
                                        <th>Pr√≥ximo Mantenimiento</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody id="equipos-tbody">
                                    <tr>
                                        <td colspan="7" class="empty-state">No hay equipos registrados</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div class="mantenimientos-section">
                        <h3>Historial de Mantenimientos</h3>
                        <div class="table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Fecha</th>
                                        <th>Equipo</th>
                                        <th>Tipo</th>
                                        <th>Descripci√≥n</th>
                                        <th>Costo</th>
                                        <th>T√©cnico</th>
                                    </tr>
                                </thead>
                                <tbody id="mantenimientos-tbody">
                                    <tr>
                                        <td colspan="6" class="empty-state">No hay mantenimientos registrados</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Reportes Page -->
            <div id="reportes-page" class="page">
                <div class="page-header">
                    <h2>Reportes y Analytics</h2>
                    <div class="page-actions">
                        <button class="btn btn-secondary" onclick="exportarReporte()">
                            <i class="fas fa-download"></i> Exportar
                        </button>
                        <button class="btn btn-primary" onclick="actualizarReportes()">
                            <i class="fas fa-sync"></i> Actualizar
                        </button>
                    </div>
                </div>
                
                <div class="reportes-content">
                    <div class="reportes-filters">
                        <select id="periodo-reporte">
                            <option value="7">√öltimos 7 d√≠as</option>
                            <option value="30">√öltimos 30 d√≠as</option>
                            <option value="90">√öltimos 3 meses</option>
                            <option value="365">√öltimo a√±o</option>
                        </select>
                        <select id="tipo-reporte">
                            <option value="ventas">Ventas</option>
                            <option value="productos">Productos</option>
                            <option value="clientes">Clientes</option>
                            <option value="materiales">Materiales</option>
                        </select>
                    </div>
                    
                    <div class="reportes-dashboard">
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-icon">
                                    <i class="fas fa-chart-line"></i>
                                </div>
                                <div class="stat-info">
                                    <h3 id="ventas-periodo">‚Ç°0</h3>
                                    <p>Ventas del Per√≠odo</p>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon">
                                    <i class="fas fa-percentage"></i>
                                </div>
                                <div class="stat-info">
                                    <h3 id="margen-promedio">0%</h3>
                                    <p>Margen Promedio</p>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon">
                                    <i class="fas fa-trophy"></i>
                                </div>
                                <div class="stat-info">
                                    <h3 id="producto-top">-</h3>
                                    <p>Producto M√°s Vendido</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="reportes-charts">
                            <div class="chart-container">
                                <h4>Top Productos</h4>
                                <div id="productos-chart" class="chart-content">
                                    <p>Cargando datos...</p>
                                </div>
                            </div>
                            
                            <div class="chart-container">
                                <h4>Top Clientes</h4>
                                <div id="clientes-chart" class="chart-content">
                                    <p>Cargando datos...</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Finanzas Page -->
            <div id="finanzas-page" class="page">
                <div class="page-header">
                    <h2>Gesti√≥n Financiera</h2>
                    <div class="page-actions">
                        <button class="btn btn-secondary" onclick="openGastoModal()">
                            <i class="fas fa-minus"></i> Registrar Gasto
                        </button>
                        <button class="btn btn-primary" onclick="openIngresoModal()">
                            <i class="fas fa-plus"></i> Registrar Ingreso
                        </button>
                    </div>
                </div>
                
                <div class="finanzas-content">
                    <div class="finanzas-resumen">
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-icon">
                                    <i class="fas fa-arrow-up" style="color: var(--success);"></i>
                                </div>
                                <div class="stat-info">
                                    <h3 id="ingresos-mes">‚Ç°0</h3>
                                    <p>Ingresos del Mes</p>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon">
                                    <i class="fas fa-arrow-down" style="color: var(--error);"></i>
                                </div>
                                <div class="stat-info">
                                    <h3 id="gastos-mes">‚Ç°0</h3>
                                    <p>Gastos del Mes</p>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon">
                                    <i class="fas fa-balance-scale"></i>
                                </div>
                                <div class="stat-info">
                                    <h3 id="balance-mes">‚Ç°0</h3>
                                    <p>Balance del Mes</p>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon">
                                    <i class="fas fa-piggy-bank"></i>
                                </div>
                                <div class="stat-info">
                                    <h3 id="flujo-caja">‚Ç°0</h3>
                                    <p>Flujo de Caja</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="finanzas-detalle">
                        <div class="movimientos-section">
                            <h3>Movimientos Recientes</h3>
                            <div class="table-container">
                                <table class="data-table">
                                    <thead>
                                        <tr>
                                            <th>Fecha</th>
                                            <th>Tipo</th>
                                            <th>Categor√≠a</th>
                                            <th>Descripci√≥n</th>
                                            <th>Monto</th>
                                            <th>Acciones</th>
                                        </tr>
                                    </thead>
                                    <tbody id="movimientos-tbody">
                                        <tr>
                                            <td colspan="6" class="empty-state">No hay movimientos registrados</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Configuraci√≥n Page -->
            <div id="configuracion-page" class="page">
                <div class="page-header">
                    <h2>Configuraci√≥n</h2>
                    <p>Ajustes generales del sistema</p>
                </div>
                
                <div class="config-container">
                    <form id="config-form" class="config-form">
                        <div class="config-section">
                            <h3>Datos del Negocio</h3>
                            <div class="form-group">
                                <label>Nombre del negocio:</label>
                                <input type="text" id="config-nombre" name="nombre" placeholder="3D Control Center">
                            </div>
                            <div class="form-group">
                                <label>Tel√©fono:</label>
                                <input type="text" id="config-telefono" name="telefono" placeholder="+506 1234-5678">
                            </div>
                            <div class="form-group">
                                <label>Direcci√≥n:</label>
                                <textarea id="config-direccion" name="direccion" placeholder="Direcci√≥n del negocio"></textarea>
                            </div>
                        </div>
                        
                        <div class="config-section">
                            <h3>Configuraci√≥n de Costos</h3>
                            <div class="form-group">
                                <label>Costo por hora predeterminado (‚Ç°):</label>
                                <input type="number" id="config-costo-hora" name="costo-hora" min="0" step="100" value="1000">
                            </div>
                            <div class="form-group">
                                <label>Margen de ganancia predeterminado (%):</label>
                                <input type="number" id="config-margen" name="margen" min="0" max="1000" step="5" value="30">
                            </div>
                            <div class="form-group">
                                <label>IVA (%):</label>
                                <input type="number" id="config-iva" name="iva" min="0" max="100" step="0.1" value="13">
                            </div>
                        </div>
                        
                        <div class="config-actions">
                            <button type="submit" class="btn btn-primary">Guardar Configuraci√≥n</button>
                            <button type="button" class="btn btn-danger" onclick="resetData()">
                                <i class="fas fa-trash"></i> Resetear Todos los Datos
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </main>
    </div>

    <!-- Modal containers -->
    <div id="modal-overlay" class="modal-overlay"></div>
    
    <!-- Cliente Modal -->
    <div id="cliente-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="cliente-modal-title">Agregar Cliente</h3>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <form id="cliente-form" class="modal-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="cliente-nombre">Nombre Completo</label>
                        <input type="text" id="cliente-nombre" name="nombre" required>
                    </div>
                    <div class="form-group">
                        <label for="cliente-email">Email</label>
                        <input type="email" id="cliente-email" name="email" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="cliente-telefono">Tel√©fono</label>
                        <input type="tel" id="cliente-telefono" name="telefono" required>
                    </div>
                    <div class="form-group">
                        <label for="cliente-cedula">C√©dula</label>
                        <input type="text" id="cliente-cedula" name="cedula">
                    </div>
                </div>
                <div class="form-group">
                    <label for="cliente-direccion">Direcci√≥n</label>
                    <textarea id="cliente-direccion" name="direccion" rows="3"></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="cliente-empresa">Empresa</label>
                        <input type="text" id="cliente-empresa" name="empresa">
                    </div>
                    <div class="form-group">
                        <label for="cliente-tipo">Tipo de Cliente</label>
                        <select id="cliente-tipo" name="tipo">
                            <option value="Individual">Individual</option>
                            <option value="Empresa">Empresa</option>
                            <option value="Gobierno">Gobierno</option>
                        </select>
                    </div>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal()">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Cotizaci√≥n Modal -->
    <div id="cotizacion-modal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3 id="cotizacion-modal-title">Nueva Cotizaci√≥n</h3>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <form id="cotizacion-form" class="modal-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="cotizacion-cliente">Cliente</label>
                        <select id="cotizacion-cliente" name="cliente" required>
                            <option value="">Seleccionar cliente</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="cotizacion-validez">Validez (d√≠as)</label>
                        <input type="number" id="cotizacion-validez" name="validez" value="30" min="1" required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="cotizacion-descripcion">Descripci√≥n del Proyecto</label>
                    <textarea id="cotizacion-descripcion" name="descripcion" rows="3" required></textarea>
                </div>
                
                <div class="cotizacion-items">
                    <h4>Items de la Cotizaci√≥n</h4>
                    <div id="cotizacion-items-container">
                        <div class="cotizacion-item">
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Descripci√≥n</label>
                                    <input type="text" name="item-descripcion" required>
                                </div>
                                <div class="form-group">
                                    <label>Cantidad</label>
                                    <input type="number" name="item-cantidad" min="1" value="1" required>
                                </div>
                                <div class="form-group">
                                    <label>Precio Unitario</label>
                                    <input type="number" name="item-precio" min="0" step="0.01" required>
                                </div>
                                <div class="form-group">
                                    <button type="button" class="btn btn-danger btn-small" onclick="removeItem(this)">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="btn btn-secondary" onclick="addCotizacionItem()">
                        <i class="fas fa-plus"></i> Agregar Item
                    </button>
                </div>
                
                <div class="cotizacion-total">
                    <h4>Total: ‚Ç°<span id="cotizacion-total-amount">0</span></h4>
                </div>
                
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal()">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Proveedor Modal -->
    <div id="proveedor-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="proveedor-modal-title">Agregar Proveedor</h3>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <form id="proveedor-form" class="modal-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="proveedor-nombre">Nombre de la Empresa</label>
                        <input type="text" id="proveedor-nombre" name="nombre" required>
                    </div>
                    <div class="form-group">
                        <label for="proveedor-contacto">Persona de Contacto</label>
                        <input type="text" id="proveedor-contacto" name="contacto" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="proveedor-email">Email</label>
                        <input type="email" id="proveedor-email" name="email" required>
                    </div>
                    <div class="form-group">
                        <label for="proveedor-telefono">Tel√©fono</label>
                        <input type="tel" id="proveedor-telefono" name="telefono" required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="proveedor-direccion">Direcci√≥n</label>
                    <textarea id="proveedor-direccion" name="direccion" rows="3"></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="proveedor-especialidad">Especialidad</label>
                        <select id="proveedor-especialidad" name="especialidad" required>
                            <option value="">Seleccionar especialidad</option>
                            <option value="Filamentos">Filamentos</option>
                            <option value="Impresoras">Impresoras</option>
                            <option value="Componentes">Componentes</option>
                            <option value="Herramientas">Herramientas</option>
                            <option value="Software">Software</option>
                            <option value="Servicios">Servicios</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="proveedor-terminos">T√©rminos de Pago</label>
                        <input type="text" id="proveedor-terminos" name="terminos" placeholder="Ej: 30 d√≠as">
                    </div>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal()">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Compra Modal -->
    <div id="compra-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Registrar Compra</h3>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <form id="compra-form" class="modal-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="compra-proveedor">Proveedor</label>
                        <select id="compra-proveedor" name="proveedor" required>
                            <option value="">Seleccionar proveedor</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="compra-fecha">Fecha</label>
                        <input type="date" id="compra-fecha" name="fecha" required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="compra-descripcion">Descripci√≥n</label>
                    <textarea id="compra-descripcion" name="descripcion" rows="3" required></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="compra-cantidad">Cantidad</label>
                        <input type="number" id="compra-cantidad" name="cantidad" min="1" required>
                    </div>
                    <div class="form-group">
                        <label for="compra-costo">Costo Total</label>
                        <input type="number" id="compra-costo" name="costo" min="0" step="0.01" required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="compra-factura">N√∫mero de Factura</label>
                    <input type="text" id="compra-factura" name="factura">
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal()">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Equipo Modal -->
    <div id="equipo-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="equipo-modal-title">Agregar Equipo</h3>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <form id="equipo-form" class="modal-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="equipo-nombre">Nombre del Equipo</label>
                        <input type="text" id="equipo-nombre" name="nombre" required>
                    </div>
                    <div class="form-group">
                        <label for="equipo-tipo">Tipo</label>
                        <select id="equipo-tipo" name="tipo" required>
                            <option value="">Seleccionar tipo</option>
                            <option value="Impresora 3D">Impresora 3D</option>
                            <option value="Computadora">Computadora</option>
                            <option value="Herramienta">Herramienta</option>
                            <option value="Accesorio">Accesorio</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="equipo-marca">Marca</label>
                        <input type="text" id="equipo-marca" name="marca" required>
                    </div>
                    <div class="form-group">
                        <label for="equipo-modelo">Modelo</label>
                        <input type="text" id="equipo-modelo" name="modelo" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="equipo-serie">N√∫mero de Serie</label>
                        <input type="text" id="equipo-serie" name="serie">
                    </div>
                    <div class="form-group">
                        <label for="equipo-compra">Fecha de Compra</label>
                        <input type="date" id="equipo-compra" name="fechaCompra">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="equipo-costo">Costo de Adquisici√≥n</label>
                        <input type="number" id="equipo-costo" name="costo" min="0" step="0.01">
                    </div>
                    <div class="form-group">
                        <label for="equipo-estado">Estado</label>
                        <select id="equipo-estado" name="estado" required>
                            <option value="Operativo">Operativo</option>
                            <option value="Mantenimiento">En Mantenimiento</option>
                            <option value="Fuera de Servicio">Fuera de Servicio</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="equipo-ubicacion">Ubicaci√≥n</label>
                    <input type="text" id="equipo-ubicacion" name="ubicacion">
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal()">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Mantenimiento Modal -->
    <div id="mantenimiento-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Registrar Mantenimiento</h3>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <form id="mantenimiento-form" class="modal-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="mantenimiento-equipo">Equipo</label>
                        <select id="mantenimiento-equipo" name="equipo" required>
                            <option value="">Seleccionar equipo</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="mantenimiento-fecha">Fecha</label>
                        <input type="date" id="mantenimiento-fecha" name="fecha" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="mantenimiento-tipo">Tipo de Mantenimiento</label>
                        <select id="mantenimiento-tipo" name="tipo" required>
                            <option value="">Seleccionar tipo</option>
                            <option value="Preventivo">Preventivo</option>
                            <option value="Correctivo">Correctivo</option>
                            <option value="Limpieza">Limpieza</option>
                            <option value="Calibraci√≥n">Calibraci√≥n</option>
                            <option value="Reparaci√≥n">Reparaci√≥n</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="mantenimiento-costo">Costo</label>
                        <input type="number" id="mantenimiento-costo" name="costo" min="0" step="0.01">
                    </div>
                </div>
                <div class="form-group">
                    <label for="mantenimiento-descripcion">Descripci√≥n del Trabajo</label>
                    <textarea id="mantenimiento-descripcion" name="descripcion" rows="4" required></textarea>
                </div>
                <div class="form-group">
                    <label for="mantenimiento-tecnico">T√©cnico</label>
                    <input type="text" id="mantenimiento-tecnico" name="tecnico">
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal()">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Ingreso Modal -->
    <div id="ingreso-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Registrar Ingreso</h3>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <form id="ingreso-form" class="modal-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="ingreso-fecha">Fecha</label>
                        <input type="date" id="ingreso-fecha" name="fecha" required>
                    </div>
                    <div class="form-group">
                        <label for="ingreso-categoria">Categor√≠a</label>
                        <select id="ingreso-categoria" name="categoria" required>
                            <option value="">Seleccionar categor√≠a</option>
                            <option value="Ventas">Ventas</option>
                            <option value="Servicios">Servicios</option>
                            <option value="Otros">Otros</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="ingreso-descripcion">Descripci√≥n</label>
                    <input type="text" id="ingreso-descripcion" name="descripcion" required>
                </div>
                <div class="form-group">
                    <label for="ingreso-monto">Monto</label>
                    <input type="number" id="ingreso-monto" name="monto" min="0" step="0.01" required>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal()">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Gasto Modal -->
    <div id="gasto-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Registrar Gasto</h3>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <form id="gasto-form" class="modal-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="gasto-fecha">Fecha</label>
                        <input type="date" id="gasto-fecha" name="fecha" required>
                    </div>
                    <div class="form-group">
                        <label for="gasto-categoria">Categor√≠a</label>
                        <select id="gasto-categoria" name="categoria" required>
                            <option value="">Seleccionar categor√≠a</option>
                            <option value="Materiales">Materiales</option>
                            <option value="Equipos">Equipos</option>
                            <option value="Servicios">Servicios</option>
                            <option value="Marketing">Marketing</option>
                            <option value="Administraci√≥n">Administraci√≥n</option>
                            <option value="Otros">Otros</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="gasto-descripcion">Descripci√≥n</label>
                    <input type="text" id="gasto-descripcion" name="descripcion" required>
                </div>
                <div class="form-group">
                    <label for="gasto-monto">Monto</label>
                    <input type="number" id="gasto-monto" name="monto" min="0" step="0.01" required>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal()">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Producto Modal -->
    <div id="producto-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="producto-modal-title">Agregar Producto</h3>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <form id="producto-modal-form" class="modal-form">
                <input type="hidden" id="producto-id" name="id">
                <div class="form-group">
                    <label>Nombre:</label>
                    <input type="text" id="producto-nombre" name="nombre" required>
                </div>
                <div class="form-group">
                    <label>Descripci√≥n:</label>
                    <textarea id="producto-descripcion" name="descripcion"></textarea>
                </div>
                <div class="form-group">
                    <label>Categor√≠a:</label>
                    <select id="producto-categoria" name="categoria" required>
                        <option value="">Seleccionar...</option>
                        <option value="Miniatura">Miniatura</option>
                        <option value="Decorativo">Decorativo</option>
                        <option value="Funcional">Funcional</option>
                        <option value="Prototipo">Prototipo</option>
                        <option value="Repuesto">Repuesto</option>
                        <option value="Otro">Otro</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Precio (‚Ç°):</label>
                    <input type="number" id="producto-precio" name="precio" min="0" step="100" required>
                </div>
                <div class="form-group">
                    <label>Stock:</label>
                    <input type="number" id="producto-stock" name="stock" min="0" required>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal()">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Insumo Modal -->
    <div id="insumo-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="insumo-modal-title">Agregar Material</h3>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <form id="insumo-modal-form" class="modal-form">
                <input type="hidden" id="insumo-id" name="id">
                <div class="form-group">
                    <label>Tipo de material:</label>
                    <select id="insumo-tipo" name="tipo" required>
                        <option value="">Seleccionar...</option>
                        <option value="PLA">PLA</option>
                        <option value="ABS">ABS</option>
                        <option value="PETG">PETG</option>
                        <option value="TPU">TPU</option>
                        <option value="PLA+">PLA+</option>
                        <option value="Wood">Wood</option>
                        <option value="Metal">Metal</option>
                        <option value="Otro">Otro</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Color:</label>
                    <input type="text" id="insumo-color" name="color" required>
                </div>
                <div class="form-group">
                    <label>Peso disponible (kg):</label>
                    <input type="number" id="insumo-peso" name="peso" min="0" step="0.1" required>
                </div>
                <div class="form-group">
                    <label>Costo por kg (‚Ç°):</label>
                    <input type="number" id="insumo-costo" name="costo" min="0" step="100" required>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal()">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Pedido Modal -->
    <div id="pedido-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="pedido-modal-title">Nuevo Pedido</h3>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <form id="pedido-modal-form" class="modal-form">
                <input type="hidden" id="pedido-id" name="id">
                <div class="form-group">
                    <label>Nombre del cliente:</label>
                    <input type="text" id="pedido-cliente" name="cliente" required>
                </div>
                <div class="form-group">
                    <label>Descripci√≥n del pedido:</label>
                    <textarea id="pedido-descripcion" name="descripcion" required></textarea>
                </div>
                <div class="form-group">
                    <label>Material:</label>
                    <select id="pedido-material" name="material" required>
                        <option value="">Seleccionar material...</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Peso (gramos):</label>
                    <input type="number" id="pedido-peso" name="peso" min="1" step="0.1" required>
                </div>
                <div class="form-group">
                    <label>Precio total (‚Ç°):</label>
                    <input type="number" id="pedido-precio" name="precio" min="0" step="100" required>
                </div>
                <div class="form-group">
                    <label>Estado:</label>
                    <select id="pedido-estado" name="estado" required>
                        <option value="Pendiente">Pendiente</option>
                        <option value="En impresi√≥n">En impresi√≥n</option>
                        <option value="Entregado">Entregado</option>
                    </select>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal()">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Factura Modal -->
    <div id="factura-modal" class="modal">
        <div class="modal-content large">
            <div class="modal-header">
                <h3>Nueva Factura</h3>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <form id="factura-modal-form" class="modal-form">
                <div class="form-group">
                    <label>Cliente:</label>
                    <input type="text" id="factura-cliente" required>
                </div>
                <div class="form-group">
                    <label>Tel√©fono:</label>
                    <input type="text" id="factura-telefono">
                </div>
                
                <div class="factura-items">
                    <h4>Items de la factura</h4>
                    <div id="factura-items-container">
                        <div class="factura-item">
                            <input type="text" placeholder="Descripci√≥n del producto/servicio" class="item-descripcion" required>
                            <input type="number" placeholder="Cantidad" class="item-cantidad" min="1" value="1" required>
                            <input type="number" placeholder="Precio unitario" class="item-precio" min="0" step="100" required>
                            <button type="button" class="btn btn-danger btn-small" onclick="removeFacturaItem(this)">√ó</button>
                        </div>
                    </div>
                    <button type="button" class="btn btn-secondary" onclick="addFacturaItem()">+ Agregar Item</button>
                </div>
                
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal()">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Generar Factura</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Factura Preview Modal -->
    <div id="factura-preview-modal" class="modal">
        <div class="modal-content large">
            <div class="modal-header">
                <h3>Vista Previa de Factura</h3>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <div id="factura-preview-content" class="factura-preview">
                <!-- Contenido de la factura se genera din√°micamente -->
            </div>
            <div class="modal-actions">
                <button type="button" class="btn btn-secondary" onclick="closeModal()">Cerrar</button>
                <button type="button" class="btn btn-primary" onclick="printFactura()">
                    <i class="fas fa-print"></i> Imprimir
                </button>
            </div>
        </div>
    </div>

    <!-- Consumo Modal -->
    <div id="consumo-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Registrar Consumo de Material</h3>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <form id="consumo-modal-form" class="modal-form">
                <div class="form-group">
                    <label>Material:</label>
                    <select id="consumo-material" name="materialId" required>
                        <option value="">Seleccionar material...</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Cantidad consumida (gramos):</label>
                    <input type="number" id="consumo-cantidad" name="cantidad" min="0.1" step="0.1" required>
                </div>
                <div class="form-group">
                    <label>Motivo del consumo:</label>
                    <select id="consumo-motivo" name="motivo">
                        <option value="Impresi√≥n">Impresi√≥n de pedido</option>
                        <option value="Prueba">Impresi√≥n de prueba</option>
                        <option value="Desperdicio">Material desperdiciado</option>
                        <option value="Calibraci√≥n">Calibraci√≥n de impresora</option>
                        <option value="Otro">Otro motivo</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Descripci√≥n (opcional):</label>
                    <textarea id="consumo-descripcion" name="descripcion" placeholder="Detalles adicionales del consumo..."></textarea>
                </div>
                <div class="form-group">
                    <label>Pedido relacionado (opcional):</label>
                    <select id="consumo-pedido" name="pedidoId">
                        <option value="">Sin pedido asociado</option>
                    </select>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal()">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Registrar Consumo</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Scripts -->
    <script src="app.js?v=2025112201"></script>
</body>
</html>